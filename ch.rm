竹巴士
与 Bambu Bus 相关的工具和文档

介绍
bambu-bus 是一种专有协议，基于通过 RS485 总线的 UART。UART 的
时钟频率为 1228800bps，具有 1 个偶校验位和 1 个停止位

标题和设备寻址
bambu 总线使用两种数据包格式，
长头数据包，其中包含指示多个可用设备之间的主从设备的数据
，以及短头数据包，用于在 1 个预设的主从设备之间进行通信

这些数据包通常由起始字节3D、数据包长度指示器和用于验证报头完整性的 8 位 CRC组成。

长格式标题
字节数	内容	占用字节数
0	0x3D	1
1	标志（小于0x80）	1
2~3	数据包序列	2
4~5	总数据包长度L	2
6	对所有先前的字节进行 CRC8 校验 [1]	1
7~8	目标地址	2
9~10	源地址	2
11~(L-3)	数据包内容	L-13
（L-2）~（L-1）	对所有先前的字节进行 CRC16 [2]	2
[1] CRC8 生成多项式：0x39，初始值 0x66，无异或和逆运算。
[2] CRC16 生成多项式：0x1021，初始值 0x913D，无异或和逆运算，但数组中低字节优先。

寻址关系
地址编号	意义
地址编号	意义
0x03	MC（运动控制器）
0x06	AP（X系列第一款上位机）
0x07	先进制造系统
0x08	TH
0x09	AP2（P、A系列中第二种上位机）
0x0E	安得拉邦
0x0F	EXT（可能是外部控制板）
0x12	AMS 精简版
0x13	四氯化碳
短格式标题
字节数	内容	占用字节数
0	0x3D	1
1	标志和序列（大于 0x80）	1
2	总数据包长度L	1
3	对所有先前的字节进行 CRC8 校验 [1]	1
4	数据包类型	1
5~(L-3)	数据包内容	L-7
（L-2）~（L-1）	对所有先前的字节进行 CRC16 [2]	2
[1] CRC8 生成多项式：0x39，初始值 0x66，无异或和逆运算。
[2] CRC16 生成多项式：0x1021，初始值 0x913D，无异或和逆运算，但数组中低字节优先。

短帧头的数据类型（在AMS lite中收集，因此列出的内容适用于AMS lite）：

价值	（可能）的含义
0x03	读取灯丝运动信息
0x04	读取和更改 AMS Lite 运动状态
0x05	验证设备是否在线
0x06	未知
0x07	读取NFC信息
0x20	打印机心跳包
工具
解析器
Protoparser.py -> 数据包解析器，最适合 X1 系列数据包
模拟器
AMCU -> 研究员 4061N 编写的 AMS 模拟器
研究团队：
4061N
leonllrmc
